{% extends "products/base.html" %}
{% load i18n %}

{% block content %}
<div class="container mt-4">
  <div class="card shadow-lg border-0 rounded-4">
    <div class="card-header bg-warning text-dark text-center rounded-top-4">
      <h4 class="mb-0">‚úèÔ∏è {% trans "Edit Product" %}: {{ product.name }}</h4>
    </div>

    <div class="card-body p-4 bg-light">
      <form method="post" enctype="multipart/form-data">
        {% csrf_token %}

        {% if messages %}
          {% for message in messages %}
            <div class="alert alert-{{ message.tags }} text-center">{{ message }}</div>
          {% endfor %}
        {% endif %}

        <div class="row g-3">
          <div class="col-md-6">
            <label class="form-label fw-bold">{% trans "Product Name" %}</label>
            <input type="text" name="name" value="{{ product.name }}" class="form-control" required>
          </div>

          <div class="col-md-6">
            <label class="form-label fw-bold">{% trans "SKU" %}</label>
            <input type="text" name="sku" value="{{ product.sku }}" class="form-control" required>
          </div>

          <div class="col-md-6">
            <label class="form-label fw-bold">{% trans "Parent Category (optional)" %}</label>
            <select name="parent_category" class="form-select">
              <option value="">{% trans "No Parent (Main Category)" %}</option>
              {% for id, name in categories %}
              <option value="{{ id }}" {% if parent_id == id %}selected{% endif %}>
                {{ name }}
              </option>
              {% endfor %}
            </select>
          </div>

          <div class="col-md-6">
            <label class="form-label fw-bold">{% trans "Category Name" %}</label>
            <input list="category-list" name="category_name" value="{{ product.category.name|default:'' }}" class="form-control">
            <datalist id="category-list">
              {% for id, name in categories %}
                <option value="{{ name }}"></option>
              {% endfor %}
            </datalist>
          </div>

          <div class="col-md-6">
            <label class="form-label fw-bold">{% trans "Product Type" %}</label>
            <select name="product_type" class="form-select">
              <option value="inventory" {% if product.product_type == "inventory" %}selected{% endif %}>{% trans "Inventory Item" %}</option>
              <option value="notinventory" {% if product.product_type == "notinventory" %}selected{% endif %}>{% trans "Non-Inventory Item" %}</option>
              <option value="service" {% if product.product_type == "service" %}selected{% endif %}>{% trans "Service" %}</option>
            </select>
          </div>

          <div class="col-md-6">
            <label class="form-label fw-bold">{% trans "Price" %}</label>
            <input type="number" name="price" step="0.01" value="{{ product.price }}" class="form-control" required>
          </div>

          <div class="col-md-6">
            <label class="form-label fw-bold">{% trans "Beginning Balance" %}</label>
            <input type="number" name="beginning_balance" value="{{ product.beginning_balance }}" min="0" class="form-control">
          </div>

          <div class="col-md-6">
            <label class="form-label fw-bold">{% trans "Current Image" %}</label><br>
            {% if product.image %}
              <img src="{{ product.image.url }}" alt="Product Image" width="100" height="100" class="rounded mb-2" style="object-fit:cover;">
            {% else %}
              <span class="text-muted">‚Äî</span>
            {% endif %}
            <input type="file" name="image" class="form-control mt-2">
          </div>

          <div class="col-12">
            <label class="form-label fw-bold">{% trans "Description" %}</label>
            <textarea name="description" class="form-control" rows="3">{{ product.description }}</textarea>
          </div>
        </div>

        <div class="text-center mt-4">
          <button class="btn btn-success px-4 py-2 fw-bold">
            üíæ {% trans "Save Changes" %}
          </button>
          <a href="{% url 'products:products_list' %}" class="btn btn-secondary px-4 py-2 ms-2">
            üîô {% trans "Back" %}
          </a>
        </div>
      </form>
    </div>
  </div>
</div>
{% endblock %}
